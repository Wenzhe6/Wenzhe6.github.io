<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>WebPack | 李文哲的个人博客</title><meta name="author" content="李文哲"><meta name="copyright" content="李文哲"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="npm 相关临时记录，后续单独开篇 ~ 在我们需要下载第三方包之前 需要先初始化项目 npm init -y: 初始化项目, 生成 package.json 文件 init 表示的是初始化 -y 表示的是所有需要填写的内容都使用默认的 package.json 字段ame：包名。规范定义它需要由小写的字母和数字组成，可以包含.、_和-，但不允许出现空格。不允许出现中文，包名必须是唯一的，以免对外公">
<meta property="og:type" content="article">
<meta property="og:title" content="WebPack">
<meta property="og:url" content="https://wenzhe6.github.io/2020/07/17/WebPack/index.html">
<meta property="og:site_name" content="李文哲的个人博客">
<meta property="og:description" content="npm 相关临时记录，后续单独开篇 ~ 在我们需要下载第三方包之前 需要先初始化项目 npm init -y: 初始化项目, 生成 package.json 文件 init 表示的是初始化 -y 表示的是所有需要填写的内容都使用默认的 package.json 字段ame：包名。规范定义它需要由小写的字母和数字组成，可以包含.、_和-，但不允许出现空格。不允许出现中文，包名必须是唯一的，以免对外公">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wenzhe6.github.io/img/webpack.png">
<meta property="article:published_time" content="2020-07-17T00:38:14.000Z">
<meta property="article:modified_time" content="2023-03-31T10:30:20.512Z">
<meta property="article:author" content="李文哲">
<meta property="article:tag" content="WebPack">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wenzhe6.github.io/img/webpack.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://wenzhe6.github.io/2020/07/17/WebPack/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'WebPack',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-31 18:30:20'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1111.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/webpack.png')"><nav id="nav"><span id="blog-info"><a href="/" title="李文哲的个人博客"><span class="site-name">李文哲的个人博客</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">WebPack</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-07-17T00:38:14.000Z" title="发表于 2020-07-17 08:38:14">2020-07-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-31T10:30:20.512Z" title="更新于 2023-03-31 18:30:20">2023-03-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WebPack/">WebPack</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="WebPack"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="npm-相关"><a href="#npm-相关" class="headerlink" title="npm 相关"></a>npm 相关</h1><p><strong>临时记录，后续单独开篇 ~</strong></p>
<p>在我们需要下载第三方包之前 需要先初始化项目</p>
<p><strong>npm init -y</strong>: 初始化项目, 生成 package.json 文件</p>
<p><strong>init</strong> 表示的是初始化</p>
<p><strong>-y</strong> 表示的是所有需要填写的内容都使用默认的</p>
<h2 id="package-json-字段"><a href="#package-json-字段" class="headerlink" title="package.json 字段"></a>package.json 字段</h2><p>ame：包名。规范定义它需要由小写的字母和数字组成，可以包含.、_和-，但不允许出现空格。不允许出现中文，<strong>包名必须是唯一的</strong>，以免对外公布时产生重名冲突的误解。除此之外，NPM 还建议不要在包名中附带上 node 或 js 来重复标识它是 JavaScript 或 Node 模块。</p>
<ul>
<li>author：作者</li>
<li>description：包的简介</li>
<li>version：版本号</li>
<li>main：入口文件</li>
<li>keywords：关键词数组，NPM 中主要用来做分类搜索。一个好的关键词数组有利于用户快速找到你编写的包。</li>
<li>devDependencies：一些模块只在开发时需要依赖。配置这个属性，可以提示包的后续开发者安装依赖包。</li>
<li>dependencies：使用当前包所需要依赖的包列表。这个属性十分重要，NPM 会通过这个属性帮助自动加载依赖的包。</li>
<li>scripts：脚本说明对象。它主要被包管理器用来安装、编译、测试和卸载包。</li>
<li>bin：一些包作者希望包可以作为命令行工具使用。配置好 bin 字段后，通过 npm install package name -g 命令可以将脚本添加到执行路径中，之后可以在命令行中直接执行。前面的 node -gyp 即是这样安装的。通过-g 命令安装的模块包称为全局模式。</li>
</ul>
<h2 id="dependencies-VS-devDependencies"><a href="#dependencies-VS-devDependencies" class="headerlink" title="dependencies VS devDependencies"></a>dependencies VS devDependencies</h2><p>dependencies：生产依赖 项目在部署运行时需要用到的依赖</p>
<p>(npm i 包名 –save 或者 npm i 包名)</p>
<p>devDependencies：开发依赖 项目在开发时候需要用到的依赖</p>
<p>(npm i 包名 –save-dev 或者 npm i 包名 -D)</p>
<p>还有一种 npm i 包名 –g：全局安装 =&gt; 安装在 nodejs 目录下的 node_modules 中</p>
<p>安装在全局的目的是为了在任意位置都能够使用该包</p>
<p>为什么能在任意位置使用它呢？因为配置了环境变量</p>
<p>初始化项目后可以通过 npm i（install） 包名，比如：npm i jquery</p>
<p>来下载第三方模块，第三方模块会默认下载到当前项目下的 node_modules 中</p>
<p>卸载第三方包：npm un（uninstall） 包名（后缀和安装包的时候保持一致）</p>
<p>npm 设置淘宝镜像源：**npm config set registry=<a target="_blank" rel="noopener" href="https://registry.npm.taobao.org/**">https://registry.npm.taobao.org/**</a></p>
<h1 id="什么是构建工具"><a href="#什么是构建工具" class="headerlink" title="什么是构建工具"></a>什么是构建工具</h1><p><strong>事实上随着前端的快速发展，目前前端的开发已经变的越来越复杂了：</strong><br>比如开发过程中我们需要通过模块化的方式来开发；</p>
<p>比如也会使用一些高级的特性来加快我们的开发效率或者安全性，比如通过 ES6+、TypeScript 开发脚本逻辑， 通过 sass、less 等方式来编写 css 样式代码；</p>
<p>比如开发过程中，我们还希望实时的监听文件的变化来并且反映到浏览器上，提高开发的效率；</p>
<p>比如开发完成后我们还需要将代码进行压缩、合并以及其他相关的优化；</p>
<p>等等….</p>
<p>上述这些工作理论上是可以人工完成的，但是它繁琐，工作量大，本质是无意义的劳动，人为的错误也随着流程的增加而增加了更多的出错率。所以每一个团队都希望有一种工具，能帮助整个团队在开发中能精简流程、提高效率、减少错误率，管理各种小工具之间的错综复杂的关系或者配置，这种工具就叫构建工具。</p>
<p>说到构建工具，我往往会在前面加<strong>「自动化」</strong>三个字，因为构建工具就是用来让我们不再做机械重复的事情，解放我们的双手的(my god)。所以构建工具作用是：提升项目性能，提高开发效率。</p>
<h1 id="构建工具的发展"><a href="#构建工具的发展" class="headerlink" title="构建工具的发展"></a>构建工具的发展</h1><p>有了工具能满足基本的打包工作，对于开发人员而言总是需要更精益求精。就像在一辆能发动的车上去安装各种零件来提升使用者的体验。这些零件就是构建工具所需要的插件，这些插件对提升开发效率很有帮助，包括语法转换（Babel），模板热更新（HotModuleReplacementPlugin），清理重复的打包的文件（clean-webpack-plugin）等等。</p>
<p>构建工具目前来说还在处于不停发展的阶段，但是相应的打包技术已经很成熟。 本次主要介绍市面上比较火热的 Gulp，Grunt， Webpack, Vite 这三个打包工具之间的对比和它们的优势。</p>
<h1 id="构建工具介绍"><a href="#构建工具介绍" class="headerlink" title="构建工具介绍"></a>构建工具介绍</h1><p>Grunt: 是一个优化前端的开发流程的工具。<br>配置一系列的 task，定义 task 处理的事务（例如文件压缩合并、启动 server、版本控制等），然后定义执行顺序，来让 Grunt 执行这些 task，从而构建项目的整个前端开发流程。</p>
<p>工作方式:<br><img src="/img/md/webpack1.png"></p>
<p>Wepack: 是一种模块化的解决方案。更强调模块化。<br>把你的项目当做一个整体，通过一个指定的主文件名（index.js, 一般是入口文件），webpack 将从这个文件开始找到你的项目所依赖的文件，使用 loaders 来处理它们，最后打包为一个浏览器可识别的 js 文件。<br><img src="/img/md/webpack2.png"></p>
<p>Vite: 一种新型前端构建工具,它区别与不同的打包工具,它在开发环境中不对项目进行整体打包。<br>原因：当我们的构建的项目越来越庞大时，对整个项目进行资源整合的时间会变长，如果有数千个模块的项目在进行构建时甚至需要几分钟才能启动开发服务器。所以 vite 解决了在开发过程中需要等待整个项目打包这一段过程，让开发时更加丝滑。<br>依赖：使用 esbuild（GO 编写）预构建依赖，比 JavaScript 编写的打包器预构建依赖快 10-100 倍。<br>源码：在浏览器请求资源时-&gt; vite 转换一些非 js 文件-&gt;动态导入代码。<br>源码利用浏览器的协商缓存（304 Not Modified），依赖模块请求则会通过 Cache-Control: max-age=31536000, immutable 进行强缓存，保持热更新的速度。<br><img src="/img/md/webpack3.png"></p>
<h1 id="如何选择适合的构建工具？"><a href="#如何选择适合的构建工具？" class="headerlink" title="如何选择适合的构建工具？"></a>如何选择适合的构建工具？</h1><p>Grunt 对于一些中小型项目而言更加轻便和灵活，如果只针对代码压缩合并，Grunt 就可以满足要求，发展历程长，基本是稳定的。但是如果要处理庞大的项目文件，特别是处理多种类型的资源文件，强调模块开发，Webpack 则更适合这个场景。Webpack 对于中大型项目而言是更加稳定的，文档资料和迭代速度也很快。当然这对开发人员而言也是挺头疼的，隔一段时间就需要去适应文档的配置。Vite 作为一门新的构建技术，想要它去构建一门稳定的中大型项目有点冒险，虽然已经发布稳定版本，但是还是会有一些潜在的风险，等它更多人推广后使用更加稳妥，但是对于平时构建一些个人网站和项目等使用 vite，感受一下它的便捷也可以。</p>
<h1 id="什么是-webpack"><a href="#什么是-webpack" class="headerlink" title="什么是 webpack"></a>什么是 webpack</h1><p><strong>webpack 是一种前端资源构建工具，一个静态模块打包器(module bundler)。 在 webpack 看来,前端的所有资源文件(js/json/css/img/less/…)都会作为模块处理。 它将根据模块的依赖关系进行静态分析，打包生成对应的静态资源(bundle)。</strong></p>
<p><img src="/img/md/webpack4.png"></p>
<h1 id="理解-module、chunk、bundle"><a href="#理解-module、chunk、bundle" class="headerlink" title="理解 module、chunk、bundle"></a>理解 module、chunk、bundle</h1><p>在 webpack 中，一切皆 module，任何一个文件都可以看成是 module。js、css、图片等都是 module<br>webpack 会将入口文件以及它的依赖引入到一个 chunk 中，然后进过一系列处理打包成 bundle</p>
<p><img src="/img/md/webpack5.png"></p>
<p>大致流程如下：</p>
<p>1、根据 index.js 入口文件依赖关系生成树状图</p>
<p>2、根据树状图引入相关的资源 生成 chunk(块)</p>
<p>3、对 chunk 进行处理 (babel、less-loader …)</p>
<p>4、打包生成 bundler.js</p>
<p>5、将 bundler.js 文件引入到 index.html 中</p>
<h1 id="webpack-五个核心概念"><a href="#webpack-五个核心概念" class="headerlink" title="webpack 五个核心概念"></a>webpack 五个核心概念</h1><h2 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h2><p><strong>入口（Entry）：指示 webpack 以哪个文件为入口起点开始打包，分析构建内部依赖图。其取值可以是字符串，数组或者一个对象</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单入口单文件</span></span><br><span class="line"><span class="attr">entry</span>: <span class="string">&quot;./src/index.js&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 单入口多文件</span></span><br><span class="line"><span class="attr">entry</span>: [<span class="string">&quot;./ src/index.js&quot;</span>, <span class="string">&quot;./src/common.js&quot;</span>] <span class="comment">// 若index.js与common.js没有依赖关系，可以通过此方式将它们打包在一起</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 多入口</span></span><br><span class="line"><span class="attr">entry</span>: &#123;</span><br><span class="line">  <span class="attr">page1</span>: <span class="string">&quot;./src/page1.js&quot;</span>,</span><br><span class="line">  <span class="attr">page2</span>: <span class="string">&quot;./src/page2.js&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p><strong>输出（Output）：指示 webpack 打包后的资源 bundles 输出到哪里去，以及如何命名</strong></p>
<p>webpack 打包的输出，常用配置如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">output</span>: &#123;</span><br><span class="line">  <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./dist&quot;</span>),</span><br><span class="line">  <span class="comment">// 单入口时（默认）</span></span><br><span class="line">  <span class="comment">// filename: &quot;main.js&quot;,</span></span><br><span class="line">  <span class="comment">// filename: &quot;js/main.js&quot;, // filename也可以写路径，表示输出到 dist/js 目录下</span></span><br><span class="line">  <span class="comment">// 多入口时，由于会有多个输出，因此文件名不能写死</span></span><br><span class="line">  <span class="attr">filename</span>: <span class="string">&quot;[name].js&quot;</span>, <span class="comment">// name表示chunk的名称，此处为entry中的key值</span></span><br><span class="line">  <span class="attr">chunkFilename</span>: <span class="string">&quot;[name].js&quot;</span>, <span class="comment">// 按需加载的模块打包后的名称</span></span><br><span class="line">  <span class="attr">publicPath</span>: <span class="string">&quot;/&quot;</span> <span class="comment">// 项目部署在服务器上的路径，如果在根路径则为 /</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h2><p><strong>处理器（Loader）：webpack 默认只能处理 js、json 格式的文件，而 loader 的作用则是将其他格式的文件，转换成 webpack 能够处理的文件</strong></p>
<p>使用 loader 需要在 webpack 配置文件的 module.rules 中配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line"> <span class="attr">entry</span>: ...,</span><br><span class="line"> <span class="attr">output</span>: ...,</span><br><span class="line"> <span class="attr">module</span>: &#123;</span><br><span class="line">   <span class="attr">noParse</span>:  <span class="regexp">/node_modules/</span>, <span class="comment">//忽略解析 node_modules 中的文件</span></span><br><span class="line">   <span class="attr">rules</span>: [</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">test</span>: <span class="regexp">/\.xxx$/</span>, <span class="comment">// 匹配后缀名为xxx的文件</span></span><br><span class="line">       <span class="comment">// 单个loader</span></span><br><span class="line">       <span class="comment">// loader: &quot;xxx-loader&quot;,</span></span><br><span class="line">       <span class="comment">// options: &#123;&#125;,</span></span><br><span class="line">       <span class="comment">// 多个loader，loader的处理顺序为从后往前，因此需要优先处理的loader放在数组最后面</span></span><br><span class="line">       <span class="comment">// use: [&quot;xxxx-loader&quot;, &quot;xxx-loader&quot;],</span></span><br><span class="line">       <span class="comment">//  如果某个loader需要配置，写成下面的格式</span></span><br><span class="line">       <span class="attr">use</span>: [</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="attr">loader</span>: <span class="string">&quot;xxxx-loader&quot;</span>,</span><br><span class="line">           <span class="attr">options</span>: &#123;&#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="string">&quot;xxx-loader&quot;</span></span><br><span class="line">       ],</span><br><span class="line">       <span class="attr">include</span>: [path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./src&quot;</span>)], <span class="comment">// 只解析src中的文件，可以是正则</span></span><br><span class="line">       <span class="attr">exclude</span>: [path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./library&quot;</span>)], <span class="comment">// 忽略library中的文件，可以是正则</span></span><br><span class="line">       <span class="comment">// 当多个规则同时匹配某类文件时，可以使用enforce参数指定优先级</span></span><br><span class="line">       <span class="attr">enforce</span>: <span class="string">&quot;pre&quot;</span> <span class="comment">// 优先执行该规则里的loader，post 最后执行该规则里的loader</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="comment">// 当规则匹配时，不再匹配后面的规则。例如某个文件匹配到了第一个规则，不再匹配后面规则</span></span><br><span class="line">       <span class="attr">oneOf</span>: [</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="attr">test</span>: <span class="regexp">/\.xxx$/</span>,</span><br><span class="line">           <span class="attr">use</span>: <span class="string">&quot;xxx-loader&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="attr">test</span>: <span class="regexp">/\.xxx$/</span>,</span><br><span class="line">           <span class="attr">use</span>: <span class="string">&quot;xxx-loader&quot;</span></span><br><span class="line">         &#125;</span><br><span class="line">       ]</span><br><span class="line">     &#125;</span><br><span class="line">   ]</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h2><p><strong>插件(Plugins)可以用于执行范围更广的任务，它能处理 loader 无法处理的事情。插件的范围包括，从打包优化和压缩， 一直到重新定义环境中的变量等。</strong></p>
<p>它使用非常简单，在 plugins 数组中添加插件的实例化对象即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xxxWebpackPlugin = <span class="built_in">require</span>(<span class="string">&quot;xxx-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: ...,</span><br><span class="line">  <span class="attr">output</span>: ...,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title function_">xxxWebpackPlugin</span>(),</span><br><span class="line">    <span class="keyword">new</span> <span class="title function_">xxxxWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="comment">// 插件的配置项</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="mode"><a href="#mode" class="headerlink" title="mode"></a>mode</h2><p><strong>webpack 打包分为两种模式，开发模式（development）与生产模式（production），默认为生产模式</strong></p>
<table>
<thead>
<tr>
<th align="left">选择</th>
<th align="left">描述</th>
<th align="left">特点</th>
</tr>
</thead>
<tbody><tr>
<td align="left">development</td>
<td align="left">会将 process.env.NODE_ENV 的值设为 development。启用 NamedChunksPlugin 和 NamedModulesPlugin。</td>
<td align="left">能让代码本地调试 运行的环境</td>
</tr>
<tr>
<td align="left">production</td>
<td align="left">会将 process.env.NODE_ENV 的值设为 production。启用 FlagDependencyUsagePlugin, FlagIncludedChunksPlugin, ModuleConcatenationPlugin, NoEmitOnErrorsPlugin, OccurrenceOrderPlugin, SideEffectsFlagPlugin 和 UglifyJsPlugin.</td>
<td align="left">能让代码优化上线 运行的环境</td>
</tr>
</tbody></table>
<p><strong>Mode 的配置更多含义</strong></p>
<p><img src="/img/md/webpack6.png"><br><img src="/img/md/webpack7.png"></p>
<h1 id="webpack-使用前提"><a href="#webpack-使用前提" class="headerlink" title="webpack 使用前提"></a>webpack 使用前提</h1><p>webpack 的官方文档是 <a target="_blank" rel="noopener" href="https://webpack.js.org/">https://webpack.js.org/</a></p>
<p>webpack 的中文官方文档是 <a target="_blank" rel="noopener" href="https://webpack.docschina.org/">https://webpack.docschina.org/</a></p>
<p>DOCUMENTATION：文档详情，也是我们最关注的</p>
<p>Webpack 的运行是依赖 Node 环境的，所以我们电脑上必须有 Node 环境</p>
<p>所以我们需要先安装 Node.js，并且同时会安装 npm；</p>
<p>我当前电脑上的 node 版本是 v14.15.5，npm 版本是 6.14.11（你也可以使用 nvm 或者 n 来管理 Node 版本）；</p>
<p>Node 官方网站：<a target="_blank" rel="noopener" href="https://nodejs.org/">https://nodejs.org/</a></p>
<p><img src="/img/md/webpack8.png"></p>
<h1 id="webpack-安装"><a href="#webpack-安装" class="headerlink" title="webpack 安装"></a>webpack 安装</h1><p><strong>webpack 的安装目前分为两个：webpack、webpack-cli</strong></p>
<h2 id="那么它们是什么关系呢？"><a href="#那么它们是什么关系呢？" class="headerlink" title="那么它们是什么关系呢？"></a>那么它们是什么关系呢？</h2><p>执行 webpack 命令，会执行 node_modules 下的.bin 目录下的 webpack；</p>
<p>webpack 在执行时是依赖 webpack-cli 的，如果没有安装就会报错；</p>
<p>而 webpack-cli 中代码执行时，才是真正利用 webpack 进行编译和打包的过程；</p>
<p>所以在安装 webpack 时，我们需要同时安装 webpack-cli（第三方的脚手架事实上是没有使用 webpack-cli 的，而是类似于自 己的 vue-service-cli 的东西）</p>
<p><img src="/img/md/webpack9.png"></p>
<p>全局安装：<strong>npm install webpack webpack-cli –g</strong></p>
<p>局部安装：<strong>npm install webpack webpack-cli –D</strong></p>
<h1 id="webpack-的默认打包"><a href="#webpack-的默认打包" class="headerlink" title="webpack 的默认打包"></a>webpack 的默认打包</h1><p>我们可以通过 webpack 进行打包，之后运行打包之后的代码</p>
<p>在目录下直接执行 webpack 命令：<strong>webpack</strong></p>
<p>生成一个 dist 文件夹，里面存放一个 main.js 的文件，就是我们打包之后的文件：</p>
<p>这个文件中的代码被压缩和丑化了；</p>
<p>另外我们发现代码中依然存在 ES6 的语法，比如箭头函数、const 等，这是因为默认情况下 webpack 并不清楚我们打包后的文 件是否需要转成 ES5 之前的语法，后续我们需要通过 babel 来进行转换和设置；</p>
<p>我们发现是可以正常进行打包的，但是有一个问题，webpack 是如何确定我们的入口的呢？</p>
<p>事实上，当我们运行 webpack 时，webpack 会查找当前目录下的 src/index.js 作为入口；</p>
<p>所以，如果当前项目中没有存在 src/index.js 文件，那么会报错；</p>
<p>当然，我们也可以通过配置来指定入口和出口</p>
<h2 id="开发环境指令"><a href="#开发环境指令" class="headerlink" title="开发环境指令"></a>开发环境指令</h2><p><strong>webpack src/js/index.js -o build/js/built.js –mode=development</strong></p>
<p>功能：webpack 能够编译打包 js 和 json 文件，并且能将 es6 的模块化语法转换成 浏览器能识别的语法。</p>
<p><strong>webpack –entry ./src/main.js –output-path ./build/js/bundle.js –mode=development</strong></p>
<h2 id="生产环境指令"><a href="#生产环境指令" class="headerlink" title="生产环境指令"></a>生产环境指令</h2><p><strong>webpack src/js/index.js -o build/js/built.js –mode=production</strong></p>
<p>功能：在开发配置功能上多一个功能，压缩代码。</p>
<p><strong>webpack –entry ./src/main.js –output-path ./build/js/bundle.js –mode=production</strong></p>
<h2 id="配置-script-脚本"><a href="#配置-script-脚本" class="headerlink" title="配置 script 脚本"></a>配置 script 脚本</h2><p>在 package.json，script 字段下配置脚本，执行命令更为简便：npm run 脚本名</p>
<p>结论 ：</p>
<ul>
<li>webpack 能够编译打包 js 和 json 文件。</li>
<li>能将 es6 的模块化语法转换成浏览器能识别的语法。</li>
<li>能压缩代码。</li>
</ul>
<p>问题 ：</p>
<ul>
<li>不能编译打包 css、img 等文件。</li>
<li>不能将 js 的 es6 基本语法转化为 es5 以下语法。</li>
<li>在通常情况下，webpack 需要打包的项目是非常复杂的，并且我们需要一系列的配置来满足要求，默认配置必然是不可以的。</li>
</ul>
<h1 id="webpack-开发环境配置"><a href="#webpack-开发环境配置" class="headerlink" title="webpack 开发环境配置"></a>webpack 开发环境配置</h1><h2 id="创建配置文件"><a href="#创建配置文件" class="headerlink" title="创建配置文件"></a>创建配置文件</h2><p>在项目根目录下创建文件 webpack.config.js，来作为 webpack 的配置文件，名字默认，如果要修改，执行时需要添加 –config 配置文件名来读取该配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>); <span class="comment">// node 内置核心模块，用来处理路径问题</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./src/js/index.js&quot;</span>, <span class="comment">// 入口文件</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// 输出配置</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;./bundle.js&quot;</span>, <span class="comment">// 输出文件名</span></span><br><span class="line">    <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build/js&quot;</span>), <span class="comment">// 输出文件路径配置</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>, <span class="comment">//开发环境</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="打包样式资源"><a href="#打包样式资源" class="headerlink" title="打包样式资源"></a>打包样式资源</h2><h3 id="1、准备-css、less-资源"><a href="#1、准备-css、less-资源" class="headerlink" title="1、准备 css、less 资源"></a>1、准备 css、less 资源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个元素</span></span><br><span class="line"><span class="keyword">let</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">div.<span class="property">className</span> = <span class="string">&#x27;dv&#x27;</span></span><br><span class="line">div.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;100px&#x27;</span></span><br><span class="line">div.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;100px&#x27;</span></span><br><span class="line">div.<span class="property">innerHTML</span> = <span class="string">&#x27;把酒祝东风，且共从容&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(div)</span><br><span class="line"></span><br><span class="line">.<span class="property">dv</span> &#123;</span><br><span class="line">  background-<span class="attr">color</span>:tomato;</span><br><span class="line">  <span class="comment">/* 页面文字不让选中 */</span></span><br><span class="line">  user-<span class="attr">select</span>: none;</span><br><span class="line">&#125;</span><br><span class="line">执行编译发现报错: 模块解析失败，你需要一个合适的loader来处理这个文件类型</span><br><span class="line"></span><br><span class="line">上面的错误信息告诉我们需要一个loader来加载这个css文件，但是loader是什么呢？</span><br><span class="line">loader 可以用于对模块的源代码进行转换；</span><br><span class="line">我们可以将css文件也看成是一个模块，我们是通过<span class="keyword">import</span>来加载这个模块的；</span><br><span class="line">在加载这个模块时，webpack其实并不知道如何对其进行加载，我们必须制定对应的loader来完成这个功能；</span><br><span class="line">那么我们需要一个什么样的loader呢？</span><br><span class="line">对于加载css文件来说，我们需要一个可以读取css文件的loader；</span><br><span class="line">这个loader最常用的是css-loader</span><br></pre></td></tr></table></figure>

<h3 id="2、下载安装-loader-包-npm-i-css-loader-D"><a href="#2、下载安装-loader-包-npm-i-css-loader-D" class="headerlink" title="2、下载安装 loader 包 npm i css-loader -D"></a>2、下载安装 loader 包 npm i css-loader -D</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">如何使用这个loader来加载css文件呢？有三种方式：</span><br><span class="line"> - 内联方式；</span><br><span class="line"> - <span class="variable constant_">CLI</span>方式（webpack5中不再使用）；</span><br><span class="line"> - 配置方式；</span><br><span class="line">内联方式：内联方式使用较少，因为不方便管理；</span><br><span class="line"> - 在引入的样式前加上使用的loader，并且使用!分割: <span class="keyword">import</span> <span class="string">&#x27;css-loader!./js/a.css&#x27;</span></span><br><span class="line"><span class="variable constant_">CLI</span>方式（webpack5中不再使用）这里不展开说</span><br></pre></td></tr></table></figure>

<h3 id="3、修改配置文件"><a href="#3、修改配置文件" class="headerlink" title="3、修改配置文件"></a>3、修改配置文件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// resolve 用来拼接绝对路径的方法</span></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// webpack 配置</span></span><br><span class="line">  <span class="comment">// 入口起点</span></span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./src/index.js&quot;</span>,</span><br><span class="line">  <span class="comment">// 输出</span></span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// 输出文件名</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;built.js&quot;</span>,</span><br><span class="line">    <span class="comment">// 输出路径</span></span><br><span class="line">    <span class="comment">// __dirname nodejs 的变量，代表当前文件的目录绝对路径</span></span><br><span class="line">    <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// loader 的配置</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="comment">// module.rules中允许我们配置多个loader（因为我们也会继续使用其他的loader，来完成其他文件的加载）</span></span><br><span class="line">    <span class="comment">// 这种方式可以更好的表示loader的配置，也方便后期的维护，同时也让你对各个Loader有一个全局的概览</span></span><br><span class="line">    <span class="comment">// rules属性对应的值是一个数组 数组中存放的是一个个的Rule，Rule是一个对象，对象中可以设置多个属性</span></span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      <span class="comment">// 详细 loader 配置</span></span><br><span class="line">      <span class="comment">// 不同文件必须配置不同 loader 处理</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 用于对 resource（资源）进行匹配的，通常会设置成正则表达式</span></span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="comment">// 对应的值时一个数组 表示使用哪些 loader 进行处理</span></span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          <span class="comment">// use 数组中 loader 执行顺序：从右到左，从下到上 依次执行</span></span><br><span class="line">          <span class="comment">// 创建 style 标签，将 js 中的样式资源插入进行，添加到 head 中生效</span></span><br><span class="line">          <span class="string">&quot;style-loader&quot;</span>,</span><br><span class="line">          <span class="comment">// 将 css 文件变成 commonjs 模块加载 js 中，里面内容是样式字符串</span></span><br><span class="line">          <span class="string">&quot;css-loader&quot;</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="comment">// use属性：对应的值时一个数组：[UseEntry]</span></span><br><span class="line">        <span class="comment">// UseEntry是一个对象，可以通过对象的属性来设置一些其他属性</span></span><br><span class="line">        <span class="comment">// loader：必须有一个 loader属性，对应的值是一个字符串；</span></span><br><span class="line">        <span class="comment">// options：可选的属性，值是一个字符串或者对象，值会被传入到loader中；</span></span><br><span class="line">        <span class="comment">// query：目前已经使用options来替代；</span></span><br><span class="line">        <span class="comment">// 传递字符串（如：use: [ &#x27;style-loader&#x27; ]）是 loader 属性的简写方式（如：use: [ &#123; loader: &#x27;style-loader&#x27;&#125; ]）；</span></span><br><span class="line">        <span class="comment">// loader属性： Rule.use: [ &#123; loader &#125; ] 的简写。</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 模式</span></span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>, <span class="comment">// 开发模式</span></span><br><span class="line">  <span class="comment">// mode: &#x27;production&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="4、运行指令：webpack-或-自定义脚本-npm-run-build"><a href="#4、运行指令：webpack-或-自定义脚本-npm-run-build" class="headerlink" title="4、运行指令：webpack 或 自定义脚本 npm run build"></a>4、运行指令：webpack 或 自定义脚本 npm run build</h3><h2 id="style-loader"><a href="#style-loader" class="headerlink" title="style-loader"></a>style-loader</h2><p>我们已经可以通过 css-loader 来加载 css 文件了</p>
<p>但是你会发现这个 css 在我们的代码中并没有生效（页面没有效果）。</p>
<p>这是为什么呢？</p>
<p>因为 css-loader 只是负责将.css 文件进行解析，并不会将解析之后的 css 插入到页面中；</p>
<p>如果我们希望再完成插入 style 的操作，那么我们还需要另外一个 loader，就是 style-loader；</p>
<p>安装 style-loader：<strong>npm install style-loader -D</strong></p>
<p>那么我们应该如何使用 style-loader：</p>
<p>在配置文件中，添加 style-loader，具体看上面代码</p>
<p>注意：因为 loader 的执行顺序是从右向左（或者说从下到上，或者说从后到前的），所以我们需要将 style- loader 写到 css-loader 的前面；</p>
<p>ps：当前目前我们的 css 是通过页内样式的方式添加进来的；</p>
<p>​ 后续我们也会讲如何将 css 抽取到单独的文件中，并且进行压缩等操作</p>
<h2 id="less-loader"><a href="#less-loader" class="headerlink" title="less-loader"></a>less-loader</h2><p>在我们开发中，我们可能会使用 less、sass、stylus 的预处理器来编写 css 样式，效率会更高。</p>
<p>那么，如何可以让我们的环境支持这些预处理器呢？</p>
<p>首先我们需要确定，less、sass 等编写的 css 需要通过工具转换成普通的 css；</p>
<p>比如我们编写如下的 less 样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@<span class="attr">fsz</span>:20px;</span><br><span class="line">@<span class="attr">fsw</span>:<span class="string">&#x27;bold&#x27;</span>;</span><br><span class="line"></span><br><span class="line">.<span class="property">dv</span> &#123;</span><br><span class="line">  font-<span class="attr">size</span>: @fsz;</span><br><span class="line">  font-<span class="attr">weight</span>: @fsw;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以使用 less 工具来完成它的编译转换：<strong>npm install less -D</strong></p>
<p>执行如下命令：<strong>npx lessc ./src/css/title.less title.css</strong></p>
<p>但是在项目中我们会编写大量的 css，它们如何可以自动转换呢？</p>
<p>这个时候我们就可以使用 less-loader，来自动使用 less 工具转换 less 到 css；</p>
<p>此时我们需要<strong>配置 webpack.config.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> <span class="attr">test</span>: <span class="regexp">/\.less$/</span>,</span><br><span class="line"> <span class="attr">use</span>: [</span><br><span class="line">  <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">  <span class="comment">// 将 less 文件编译成 css 文件</span></span><br><span class="line">  <span class="comment">// 需要下载 less-loader 和 less</span></span><br><span class="line">  <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line"> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="PostCss"><a href="#PostCss" class="headerlink" title="PostCss"></a>PostCss</h2><h3 id="什么是-PostCSS-呢？"><a href="#什么是-PostCSS-呢？" class="headerlink" title="什么是 PostCSS 呢？"></a>什么是 PostCSS 呢？</h3><p>PostCSS 是一个通过 JavaScript 来转换样式的工具；</p>
<p>这个工具可以帮助我们进行一些 CSS 的转换和适配，比如自动添加浏览器前缀、css 样式的重置；</p>
<p>但是实现这些功能，我们需要借助于 PostCSS 对应的插件；</p>
<p>如何使用 PostCSS 呢？主要就是两个步骤：</p>
<p><strong>第一步：查找 PostCSS 在构建工具中的扩展，比如 webpack 中的 postcss-loader；</strong></p>
<p><strong>第二步：选择可以添加你需要的 PostCSS 相关的插件；</strong></p>
<p>当然，我们能不能也直接在终端使用 PostCSS 呢？</p>
<p>也是可以的，但是我们需要单独安装一个工具 postcss-cli；</p>
<p>我们可以安装一下它们：postcss、postcss-cli</p>
<p><strong>npm install postcss postcss-cli -D</strong></p>
<p>我们编写一个需要添加前缀的 css：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.<span class="property">dv</span> &#123;</span><br><span class="line">  <span class="comment">/* 页面文字不让选中 */</span></span><br><span class="line">  user-<span class="attr">select</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="autoprefixer"><a href="#autoprefixer" class="headerlink" title="autoprefixer"></a>autoprefixer</h3><p>因为我们需要添加前缀，所以要安装 autoprefixer：</p>
<p><strong>npm install autoprefixer -D</strong></p>
<p>直接使用使用 postcss 工具，并且制定使用 autoprefixer</p>
<p><strong>npx postcss –use autoprefixer -o end.css ./src/css/style.css</strong></p>
<h3 id="postcss-loader"><a href="#postcss-loader" class="headerlink" title="postcss-loader"></a>postcss-loader</h3><p>真实开发中我们必然不会直接使用命令行工具来对 css 进行处理，而是可以借助于构建工具：</p>
<p>在 webpack 中使用 postcss 就是使用 postcss-loader 来处理的；</p>
<p>我们来安装 postcss-loader：</p>
<p><strong>npm install postcss-loader -D</strong></p>
<p>我们修改加载 css 的 loader：（配置文件已经过多，给出一部分了）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">loader</span>: <span class="string">&quot;postcss-loader&quot;</span>,</span><br><span class="line">  <span class="attr">options</span>: &#123;</span><br><span class="line">  <span class="attr">postcssOptions</span>: &#123;</span><br><span class="line">  <span class="comment">// 使用插件</span></span><br><span class="line">  <span class="comment">// ps:因为postcss需要有对应的插件才会起效果，所以我们需要配置它的plugin；</span></span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">  <span class="comment">// 引入插件</span></span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&#x27;autoprefixer&#x27;</span>)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然，我们也可以将这些配置信息放到一个单独的文件中进行管理：</p>
<p>在根目录下创建 postcss.config.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="built_in">require</span>(<span class="string">&quot;autoprefixer&quot;</span>)],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="postcss-preset-env"><a href="#postcss-preset-env" class="headerlink" title="postcss-preset-env"></a>postcss-preset-env</h3><p>事实上，在配置 postcss-loader 时，我们配置插件并不需要使用 autoprefixer。</p>
<p>我们可以使用另外一个插件：postcss-preset-env</p>
<p>postcss-preset-env 也是一个 postcss 的插件；</p>
<p>它可以帮助我们将一些现代的 CSS 特性，转成大多数浏览器认识的 CSS，并且会根据目标浏览器或者运行时环境 添加所需的 polyfill；</p>
<p>也包括会自动帮助我们添加 autoprefixer（所以相当于已经内置了 autoprefixer）；</p>
<p>首先，我们需要安装 postcss-preset-env：</p>
<p><strong>npm install postcss-preset-env -D</strong></p>
<p>之后，我们直接修改掉之前的 autoprefixer 即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">loader</span>: <span class="string">&quot;postcss-loader&quot;</span>,</span><br><span class="line">  <span class="attr">options</span>: &#123;</span><br><span class="line">  <span class="attr">postcssOptions</span>: &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&#x27;postcss-preset-env&#x27;</span>)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="打包-HTML-资源"><a href="#打包-HTML-资源" class="headerlink" title="打包 HTML 资源"></a>打包 HTML 资源</h2><h3 id="HtmlWebpackPlugin"><a href="#HtmlWebpackPlugin" class="headerlink" title="HtmlWebpackPlugin"></a>HtmlWebpackPlugin</h3><p>另外还有一个<strong>不太规范</strong>的地方：</p>
<p>我们的 HTML 文件是编写在根目录下的，而最终打包的 dist 文件夹中是没有 index.html 文件的。</p>
<p>在进行项目部署的时，必然也是需要有对应的入口文件 index.html；</p>
<p>所以我们也需要对 index.html 进行打包处理；</p>
<p>对 HTML 进行打包处理我们可以使用另外一个插件：<strong>HtmlWebpackPlugin；</strong></p>
<p>1、创建 html 页面</p>
<p>2、下载安装 plugin 包：npm install -D html-webpack-plugin</p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="comment">// html-webpack-plugin</span></span><br><span class="line">    <span class="comment">//功能：默认会创建一个空的 HTML，自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">    <span class="comment">//需求：需要有结构的 HTML文件</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="comment">//复制 &#x27;./src/index.html&#x27;文件，并自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">      <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="打包图片资源"><a href="#打包图片资源" class="headerlink" title="打包图片资源"></a>打包图片资源</h2><h3 id="file-loader"><a href="#file-loader" class="headerlink" title="file-loader"></a>file-loader</h3><blockquote>
<p>参考文章：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c0de85a2d3fb">https://www.jianshu.com/p/c0de85a2d3fb</a></p>
</blockquote>
<h4 id="1、创建图片资源"><a href="#1、创建图片资源" class="headerlink" title="1、创建图片资源"></a>1、创建图片资源</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">方式一:</span><br><span class="line"><span class="keyword">let</span> dv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">dv.<span class="property">className</span> = <span class="string">&#x27;box&#x27;</span></span><br><span class="line">dv.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line">dv.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(dv)</span><br><span class="line"></span><br><span class="line">.<span class="property">box</span> &#123;</span><br><span class="line">  background-<span class="attr">image</span>: <span class="title function_">url</span>(<span class="string">&#x27;../imgs/2.jpg&#x27;</span>);</span><br><span class="line">  background-<span class="attr">repeat</span>: no-repeat;</span><br><span class="line">  background-<span class="attr">size</span>: contain;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">方式二:</span><br><span class="line"><span class="keyword">import</span> imgUrl <span class="keyword">from</span> <span class="string">&#x27;./imgs/1.png&#x27;</span></span><br><span class="line"><span class="keyword">let</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line"><span class="comment">// img.src = &#x27;./imgs/1.png&#x27;</span></span><br><span class="line">img.<span class="property">src</span> = imgUrl</span><br><span class="line">img.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line">img.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;400px&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(img)</span><br></pre></td></tr></table></figure>

<p>2、下载安装 loader 包 npm install –save-dev file-loader</p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./src/index.js&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;built.js&quot;</span>,</span><br><span class="line">    <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;build&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/</span>,</span><br><span class="line">        <span class="attr">use</span>: &#123;</span><br><span class="line">          <span class="attr">loader</span>: <span class="string">&quot;file-loader&quot;</span>,</span><br><span class="line">          <span class="attr">options</span>: &#123;</span><br><span class="line">            <span class="attr">esModule</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;imgs/[name]-[hash:5].[ext]&quot;</span>,</span><br><span class="line">            <span class="comment">// outputPath: imgs</span></span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;javascript/auto&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="文件命名规则"><a href="#文件命名规则" class="headerlink" title="文件命名规则"></a>文件命名规则</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">有时候我们处理后的文件名称按照一定的规则进行显示：</span><br><span class="line">比如保留原来的文件名、扩展名，同时为了防止重复，包含一个hash值等；</span><br><span class="line">这个时候我们可以使用PlaceHolders来完成，webpack给我们提供了大量的PlaceHolders来显示不同的内容：</span><br><span class="line">https://webpack.js.org/loaders/file-loader/#placeholders</span><br><span class="line">我们可以在文档中查阅自己需要的placeholder；</span><br><span class="line">我们这里介绍几个最常用的placeholder：</span><br><span class="line">[ext]： 处理文件的扩展名；</span><br><span class="line">[name]：处理文件的名称；</span><br><span class="line">[hash]：文件的内容，使用MD4的散列函数处理，生成的一个128位的hash值（32个十六进制）；</span><br><span class="line">[contentHash]：在file-loader中和[hash]结果是一致的（在webpack的一些其他地方不一样，后面会讲到）；</span><br><span class="line">[hash:&lt;length&gt;]：截图hash的长度，默认32个字符太长了；</span><br><span class="line">[path]：文件相对于webpack配置文件的路径；</span><br></pre></td></tr></table></figure>

<h3 id="url-loader"><a href="#url-loader" class="headerlink" title="url-loader"></a>url-loader</h3><p><strong>url-loader</strong>和<strong>file-loader</strong>的工作方式是相似的，但是可以将较小的文件，转成 base64 的 URI</p>
<p>安装：<strong>npm install url-loader -D</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/i</span>,</span><br><span class="line">  <span class="attr">use</span>: &#123;</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;[name]-[hash:5].[ext]&#x27;</span>,</span><br><span class="line">          <span class="attr">outputPath</span>: <span class="string">&#x27;imgs&#x27;</span>,</span><br><span class="line">          <span class="attr">limit</span>: <span class="number">20</span> * <span class="number">1024</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>显示结果是一样的，并且图片可以正常显示；</strong></p>
<p>但是在 dist 文件夹中，我们会看不到图片文件：</p>
<p>因为默认情况下 url-loader 会将所有的图片文件转成 base64 编码</p>
<p>但是开发中我们往往是小的图片需要转换，但是大的图片直接使用图片即可</p>
<p>这是因为小的图片转换 base64 之后可以和页面一起被请求，减少不必要的请求过程；</p>
<p>而大的图片也进行转换，反而会影响页面的请求速度；</p>
<p>那么，我们如何可以<strong>限制哪些大小的图片转换和不转换</strong>呢？</p>
<p>url-loader 有一个<strong>options</strong>属性<strong>limit</strong>，可以用于设置转换的限制；</p>
<blockquote>
<p><strong>url-loader 在 webpack5 中已废弃</strong><br>参考文章：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/36e972b19b28">https://www.jianshu.com/p/36e972b19b28</a></p>
</blockquote>
<h3 id="html-loader"><a href="#html-loader" class="headerlink" title="html-loader"></a>html-loader</h3><p>在 html 中引入一张图片，npm run build 后发现该图片无法打包</p>
<p>解决方式：</p>
<p>安装 html-loader <strong>npm i html-loader -D</strong></p>
<p>修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 处理html中的图片</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="attr">test</span>: <span class="regexp">/\.(html|htm)$/</span>,</span><br><span class="line">   <span class="comment">// 处理html文件的img图片(负责引入img, 从而能被url-loader进行处理)</span></span><br><span class="line">   <span class="attr">loader</span>: <span class="string">&#x27;html-loader&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="打包其它资源"><a href="#打包其它资源" class="headerlink" title="打包其它资源"></a>打包其它资源</h2><h3 id="1、引入字体图标"><a href="#1、引入字体图标" class="headerlink" title="1、引入字体图标"></a>1、引入字体图标</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> elI = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;i&quot;</span>);</span><br><span class="line">elI.<span class="property">className</span> = <span class="string">&quot;icomoon icon-heart&quot;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(elI);</span><br></pre></td></tr></table></figure>

<p>2、下载 file-loader ：npm i file-loader -D</p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增规则 =&gt; 打包其他资源(除了 html/js/css资源以外的资源)</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">//排除 css/js/html资源</span></span><br><span class="line">   <span class="attr">exclude</span>: <span class="regexp">/\.(css|js|html|less)$/</span>,</span><br><span class="line">   <span class="attr">loader</span>: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">   <span class="attr">options</span>: &#123;</span><br><span class="line">   <span class="attr">esModule</span>: <span class="literal">false</span>,</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;fonts/[hash:10].[ext]&#x27;</span></span><br><span class="line"> &#125;,</span><br><span class="line">   <span class="attr">type</span>: <span class="string">&#x27;javascript/auto&#x27;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h1 id="asset-module-type"><a href="#asset-module-type" class="headerlink" title="asset module type"></a>asset module type</h1><p>我们当前使用的 webpack 版本是 webpack5：</p>
<p>在 webpack5 之前，加载这些资源我们需要使用一些 loader，比如 raw-loader 、url-loader、file-loader；</p>
<p>在 webpack5 开始，我们可以直接使用资源模块类型（<strong>asset module type</strong>），来替代上面的这些 loader；</p>
<p>**资源模块类型(asset module type)**，通过添加 4 种新的模块类型，来替换所有这些 loader：</p>
<p><strong>asset/resource</strong> 发送一个单独的文件并导出 URL。之前通过使用 file-loader 实现；</p>
<p><strong>asset/inline</strong> 导出一个资源的 data URI。之前通过使用 url-loader 实现；</p>
<p><strong>asset/source</strong> 导出资源的源代码。之前通过使用 raw-loader 实现；</p>
<p><strong>asset</strong> 在导出一个 data URI 和发送一个单独的文件之间自动选择。之前通过 url-loader + limit 配置资源体积限制实现；</p>
<h3 id="比如打包图片"><a href="#比如打包图片" class="headerlink" title="比如打包图片"></a>比如打包图片</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/i</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;asset&#x27;</span>,</span><br><span class="line">    <span class="comment">// 生成器</span></span><br><span class="line">    <span class="attr">generator</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;img/[name].[hash:5][ext]&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 解析</span></span><br><span class="line">  <span class="attr">parser</span>: &#123;</span><br><span class="line">    <span class="comment">// 条件</span></span><br><span class="line">    <span class="attr">dataUrlCondition</span>: &#123;</span><br><span class="line">      <span class="comment">// 小于20kb的图片都转成base64位</span></span><br><span class="line">      <span class="attr">maxSize</span>: <span class="number">20</span> * <span class="number">1024</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="转-base64"><a href="#转-base64" class="headerlink" title="转 base64"></a>转 base64</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">因为不生成文件，所以没有generator属性</span><br><span class="line">&#123;</span><br><span class="line"> <span class="attr">test</span>: <span class="regexp">/\.(png|jpe?g|gif|svg)$/i</span>,</span><br><span class="line"> <span class="attr">type</span>: <span class="string">&#x27;asset/inline&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="比如打包字体"><a href="#比如打包字体" class="headerlink" title="比如打包字体"></a>比如打包字体</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.(woff2?|eot|ttf)$/</span>,</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;asset/resource&#x27;</span>,</span><br><span class="line">  <span class="attr">generator</span>: &#123;</span><br><span class="line">     <span class="attr">filename</span>: <span class="string">&#x27;font/[name].[ext]&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Plugins-1"><a href="#Plugins-1" class="headerlink" title="Plugins"></a>Plugins</h1><p><strong>Webpack</strong> 的另一个核心是 Plugin，官方有这样一段对 Plugin 的描述：</p>
<p>While loaders are used to transform certain types of modules, plugins can be leveraged to perform a wider range of tasks like bundle optimization, asset management and injection of environment variables.</p>
<p>上面表达的含义翻译过来就是：</p>
<p>Loader 是用于特定的模块类型进行转换；</p>
<p>Plugin 可以用于执行更加广泛的任务，比如打包优化、资源管理、环境变量注入等</p>
<p><img src="/img/md/webpack10.png"></p>
<h2 id="CleanWebpackPlugin"><a href="#CleanWebpackPlugin" class="headerlink" title="CleanWebpackPlugin"></a>CleanWebpackPlugin</h2><p>前面我们演示的过程中，每次修改了一些配置，重新打包时，都需要手动删除 build 文件夹：</p>
<p>我们可以借助于一个插件来帮助我们完成，这个插件就是 CleanWebpackPlugin；</p>
<p>首先，我们先安装这个插件：</p>
<p><strong>npm install clean-webpack-plugin -D</strong></p>
<p>修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;clean-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="HtmlWebpackPlugin-1"><a href="#HtmlWebpackPlugin-1" class="headerlink" title="HtmlWebpackPlugin"></a>HtmlWebpackPlugin</h2><p>对 HTML 进行打包处理我们可以使用另外一个插件：HtmlWebpackPlugin；</p>
<p>1、创建 html 页面</p>
<p>2、下载安装 plugin 包：npm install -D html-webpack-plugin</p>
<p>3、修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// plugins的配置</span></span><br><span class="line">    <span class="comment">// html-webpack-plugin</span></span><br><span class="line">    <span class="comment">//功能：默认会创建一个空的 HTML，自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">    <span class="comment">//需求：需要有结构的 HTML文件</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="comment">//复制 &#x27;./src/index.html&#x27;文件，并自动引入打包输出的所有资源（JS/CSS）</span></span><br><span class="line">      <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>自定义 html 模板</p>
<p>如果我们想在自己的模块中加入一些比较特别的内容：</p>
<p>比如添加一个 noscript 标签，在用户的 JavaScript 被关闭时，给予响应的提示；</p>
<p>比如在开发 vue 或者 react 项目时，我们需要一个可以挂载后续组件的根标签；</p>
<p>我们需要一个属于自己的模板</p>
<p>我们选择复制 vue 的 index.html 作为模板</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html lang=&quot;&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;link rel=&quot;icon&quot; href=&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;%= htmlWebpackPlugin.options.title %&gt;&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;noscript&gt;</span><br><span class="line">      &lt;strong&gt;We&#x27;re sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn&#x27;t work properly without JavaScript enabled. Please enable it to continue.&lt;/strong&gt;</span><br><span class="line">    &lt;/noscript&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;!-- built files will be auto injected --&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>上面的代码中，会有一些类似这样的语法&lt;%= 变量 %&gt;，这个是 EJS 模块填充数据的方式。</p>
<p>在配置 HtmlWebpackPlugin 时，我们可以添加如下配置：</p>
<p>template：指定我们要使用的模块所在的路径；</p>
<p>title：在进行 htmlWebpackPlugin.options.title 读取时，就会读到该信息；</p>
<p>但是，这个时候编译还是会报错，因为在我们的模块中还使用到一个<strong>BASE_URL</strong>的常量：</p>
<p><img src="/img/md/webpack11.png"></p>
<p>这是因为在编译 template 模块时，有一个 BASE_URL：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">&quot;icon&quot;</span> href=<span class="string">&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>但是我们并没有设置过这个常量值，所以会出现没有定义的错误；</p>
<p>这个时候我们可以使用 DefinePlugin 插件</p>
<h2 id="DefinePlugin"><a href="#DefinePlugin" class="headerlink" title="DefinePlugin"></a>DefinePlugin</h2><p>DefinePlugin 允许在编译时创建配置的全局常量，是一个 webpack 内置的插件（不需要单独安装）：</p>
<p><img src="/img/md/webpack12.png"></p>
<p>这个时候，编译 template 就可以正确的编译了，会读取到 BASE_URL 的值</p>
<h2 id="CopyWebpackPlugin"><a href="#CopyWebpackPlugin" class="headerlink" title="CopyWebpackPlugin"></a>CopyWebpackPlugin</h2><p>在 vue 的打包过程中，如果我们将一些文件放到 public 的目录下，那么这个目录会被复制到 dist 文件夹中。</p>
<p>这个复制的功能，我们可以使用 CopyWebpackPlugin 来完成；</p>
<p>安装 CopyWebpackPlugin 插件：</p>
<p><strong>npm install copy-webpack-plugin -D</strong></p>
<p>接下来<strong>配置 CopyWebpackPlugin</strong>即可：</p>
<p>复制的规则在 patterns 中设置；</p>
<p><strong>from：</strong>设置从哪一个源中开始复制；</p>
<p><strong>to：</strong>复制到的位置，可以省略，会默认复制到打包的目录下；</p>
<p><strong>globOptions：</strong>设置一些额外的选项，其中可以编写需要忽略的文件：</p>
<p>.DS_Store：mac 目录下回自动生成的一个文件；</p>
<p>index.html：也不需要复制，因为我们已经通过 HtmlWebpackPlugin 完成了 index.html 的生成；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title function_">copyWebpackPlugin</span>(&#123;</span><br><span class="line">  <span class="attr">patterns</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">from</span>: <span class="string">&#x27;public&#x27;</span>,</span><br><span class="line">      <span class="attr">globOptions</span>: &#123;</span><br><span class="line">        <span class="comment">// 忽略</span></span><br><span class="line">        <span class="attr">ignore</span>: [</span><br><span class="line">          <span class="string">&#x27;**/.DS_Store&#x27;</span></span><br><span class="line">          <span class="string">&#x27;**/index.html&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="Babel-相关"><a href="#Babel-相关" class="headerlink" title="Babel 相关"></a>Babel 相关</h1><p>事实上，在开发中我们很少直接去接触 babel，但是 <strong>babel</strong> 对于前端开发来说，目前是不可缺少的一部分：</p>
<p>开发中，我们想要使用 ES6+的语法，想要使用 TypeScript，开发 React 项目，它们都是离不开 Babel 的；</p>
<p>所以，学习 Babel 对于我们理解代码从编写到线上的转变过程至关重要；</p>
<p>那么，<strong>Babel 到底是什么呢？</strong></p>
<p>Babel 是一个工具链，主要用于旧浏览器或者环境中将 ECMAScript 2015+代码转换为向后兼容版本的 JavaScript；</p>
<p>包括：语法转换、源代码转换等；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> num = (<span class="number">10</span>)[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)].<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Babel-命令行使用"><a href="#Babel-命令行使用" class="headerlink" title="Babel 命令行使用"></a>Babel 命令行使用</h3><p>babel 本身可以作为<strong>一个独立的工具</strong>（和 postcss 一样），不和 webpack 等构建工具配置来单独使用。</p>
<p>如果我们希望在命令行尝试使用 babel，需要安装如下库：</p>
<p>@babel/core：babel 的核心代码，必须安装；</p>
<p>@babel/cli：可以让我们在命令行使用 babel；</p>
<p><strong>npm install @babel/cli @babel/core -D</strong></p>
<p>使用 babel 来处理我们的源代码：</p>
<p>src：是源文件的目录；</p>
<p>–out-dir：指定要输出的文件夹 dist；</p>
<p><strong>npx babel src –out-dir dist</strong></p>
<h3 id="插件的使用"><a href="#插件的使用" class="headerlink" title="插件的使用"></a>插件的使用</h3><p>比如我们需要转换箭头函数，那么我们就可以使用<strong>箭头函数转换相关的插件</strong></p>
<p><strong>npm install @babel/plugin-transform-arrow-functions -D</strong></p>
<p><strong>npx babel src –out-dir dist --plugins=@babel/plugin-transform-arrow-functions</strong></p>
<p>查看转换后的结果：我们会发现 const 并没有转成 var</p>
<p>这是因为 plugin-transform-arrow-functions，并没有提供这样的功能；</p>
<p>我们需要使用 plugin-transform-block-scoping 来完成这样的功能；</p>
<p><strong>npm install @babel/plugin-transform-block-scoping -D</strong></p>
<p><strong>npx babel src –out-dir dist --plugins=@babel/plugin-transform-block-scoping,@babel/plugin-transform-arrow-functions</strong></p>
<h3 id="Babe-的预设-preset"><a href="#Babe-的预设-preset" class="headerlink" title="Babe 的预设 preset"></a>Babe 的预设 preset</h3><p>但是如果要转换的内容过多，一个个设置是比较麻烦的，我们可以使用预设（preset）：</p>
<p>后面我们再具体来讲预设代表的含义；</p>
<p>安装@babel/preset-env 预设：</p>
<p><strong>npm install @babel/preset-env -D</strong></p>
<p>执行如下命令：</p>
<p><strong>npx babel src –out-dir dist --presets=@babel/preset-env</strong></p>
<h3 id="Babel-的底层原理"><a href="#Babel-的底层原理" class="headerlink" title="Babel 的底层原理"></a>Babel 的底层原理</h3><p>babel 是如何做到将我们的一段代码（ES6、TypeScript、React）转成另外一段代码（ES5）的呢？</p>
<p>从一种源代码（原生语言）转换成另一种源代码（目标语言），这是什么的工作呢？</p>
<p>就是<strong>编译器</strong>，事实上我们可以将 babel 看成就是一个编译器。</p>
<p>Babel 编译器的作用就是将我们的源代码，转换成浏览器可以直接识别的另外一段源代码；</p>
<h3 id="Babel-也拥有编译器的工作流程"><a href="#Babel-也拥有编译器的工作流程" class="headerlink" title="Babel 也拥有编译器的工作流程"></a>Babel 也拥有编译器的工作流程</h3><ul>
<li>解析阶段（Parsing)</li>
<li>转换阶段（Transformation）</li>
<li>生成阶段（Code Generation）</li>
</ul>
<blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://github.com/jamiebuilds/the-super-tiny-compiler">https://github.com/jamiebuilds/the-super-tiny-compiler</a></p>
</blockquote>
<h3 id="Babel-编译器执行原理"><a href="#Babel-编译器执行原理" class="headerlink" title="Babel 编译器执行原理"></a>Babel 编译器执行原理</h3><p><img src="/img/md/webpack13.png"></p>
<p>当然，这只是一个简化版的编译器工具流程，在每个阶段又会有自己具体的工作</p>
<p><img src="/img/md/webpack14.png"></p>
<h3 id="babel-loader"><a href="#babel-loader" class="headerlink" title="babel-loader"></a>babel-loader</h3><p>在实际开发中，我们通常会在构建工具中通过配置 babel 来对其进行使用的，比如在 webpack 中。</p>
<p>那么我们就需要去安装相关的依赖：</p>
<p>如果之前已经安装了@babel/core，那么这里不需要再次安装；</p>
<p><strong>npm install babel-loader @babel/core</strong></p>
<p>我们可以设置一个规则，在加载 js 文件时，使用我们的 babel</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/.js$/</span>,</span><br><span class="line">    <span class="attr">use</span>: &#123;</span><br><span class="line">    <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">      <span class="comment">// 指定使用的插件</span></span><br><span class="line">      <span class="comment">// plugins: [</span></span><br><span class="line">      <span class="comment">//   &quot;@babel/plugin-transform-arrow-functions&quot;,</span></span><br><span class="line">      <span class="comment">//   &quot;@babel/plugin-transform-block-scoping&quot;</span></span><br><span class="line">      <span class="comment">// ]</span></span><br><span class="line">      <span class="comment">// 指定预设环境</span></span><br><span class="line">      <span class="comment">// presets: [</span></span><br><span class="line">      <span class="comment">//   [&quot;@babel/preset-env&quot;]</span></span><br><span class="line">      <span class="comment">// ]</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="babel-preset-env"><a href="#babel-preset-env" class="headerlink" title="babel/preset-env"></a>babel/preset-env</h2><p>如果我们一个个去安装使用插件，那么需要手动来管理大量的 babel 插件，我们可以直接给 webpack 提供一个 preset，webpack 会根据我们的预设来加载对应的插件列表，并且将其传递给 babel。</p>
<p>比如常见的预设有三个：</p>
<ul>
<li>env</li>
<li>react</li>
<li>TypeScript</li>
</ul>
<p>安装 preset-env：</p>
<p><strong>npm install @babel/preset-env</strong></p>
<p>配置文件修改看上面</p>
<h2 id="babel-配置文件"><a href="#babel-配置文件" class="headerlink" title="babel 配置文件"></a>babel 配置文件</h2><p>像之前一样，我们可以将 babel 的配置信息放到一个独立的文件中，babel 给我们提供了两种配置文件的编写：</p>
<p>babel.config.json（或者.js，.cjs，.mjs）文件；</p>
<p>.babelrc.json（或者.babelrc，.js，.cjs，.mjs）文件；</p>
<p>它们两个有什么区别呢？目前很多的项目都采用了多包管理的方式（babel 本身、element-plus、umi 等）；</p>
<p>.babelrc.json：早期使用较多的配置方式，但是对于配置 Monorepos 项目是比较麻烦的；</p>
<p>babel.config.js（babel7）：可以直接作用于 Monorepos 项目的子包，更加推荐；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">presets</span>: [<span class="string">&quot;@babel/preset-env&quot;</span>],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="corejs"><a href="#corejs" class="headerlink" title="corejs"></a>corejs</h2><p><strong>js 兼容性处理：babel-loader @babel/core</strong></p>
<ul>
<li>基本 js 兼容性处理 –&gt; @babel/preset-env<ul>
<li>问题：只能转换基本语法，如 promise 高级语法不能转换</li>
</ul>
</li>
<li>全部 js 兼容性处理 –&gt; @babel/polyfill</li>
<li>问题：我只要解决部分兼容性问题，但是将所有兼容性代码全部引入，体积太大了~</li>
<li>需要做兼容性处理的就做：按需加载 –&gt; core-js</li>
</ul>
<p>配置文件修改</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">      <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">    <span class="comment">// 预设：指示babel做怎么样的兼容性处理</span></span><br><span class="line">    <span class="attr">presets</span>: [</span><br><span class="line">      [</span><br><span class="line">        <span class="string">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">// 按需加载</span></span><br><span class="line">          <span class="attr">useBuiltIns</span>: <span class="string">&#x27;usage&#x27;</span>,</span><br><span class="line">          <span class="comment">// 指定core-js版本</span></span><br><span class="line">          <span class="attr">corejs</span>: &#123;</span><br><span class="line">            <span class="attr">version</span>: <span class="number">3</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">// 指定兼容性做到哪个版本浏览器</span></span><br><span class="line">          <span class="attr">targets</span>: &#123;</span><br><span class="line">            <span class="attr">chrome</span>: <span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">            <span class="attr">firefox</span>: <span class="string">&#x27;60&#x27;</span>,</span><br><span class="line">            <span class="attr">ie</span>: <span class="string">&#x27;9&#x27;</span>,</span><br><span class="line">            <span class="attr">safari</span>: <span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">            <span class="attr">edge</span>: <span class="string">&#x27;17&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h2><p>我们希望通过 eslint 对 js 语法进行检查 目的为了统一编码规范</p>
<p>1、官网查找 eslint-loader 发现过期了 官网推荐使用 eslint-webpack-plugin<br>2、找到 eslint-webpack-plugin 包 提示需要安装 eslint 包<br>3、安装完以后 webpack 执行命令报错 src 路径下缺少.eslintrc.js 文件(自定义校验规则文件)<br>4、在 src 下新增**.eslintrc.js**文件 自定义编码规则 webpack 执行检查是否生效</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">env</span>: &#123;</span><br><span class="line">    <span class="attr">browser</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">es6</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">node</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">extends</span>: <span class="string">&quot;eslint:recommended&quot;</span>,</span><br><span class="line">  <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">    <span class="attr">ecmaVersion</span>: <span class="number">2015</span>,</span><br><span class="line">    <span class="attr">sourceType</span>: <span class="string">&quot;module&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="comment">// 缩进</span></span><br><span class="line">    <span class="attr">indent</span>: [</span><br><span class="line">      <span class="string">&quot;error&quot;</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="comment">//我的是编辑器自动格式化，不是使用tabs，而是四个空格</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;linebreak-style&quot;</span>: [<span class="string">&quot;error&quot;</span>, <span class="string">&quot;windows&quot;</span>], <span class="comment">// 引号</span></span><br><span class="line">    <span class="attr">quotes</span>: [<span class="number">1</span>, <span class="string">&quot;single&quot;</span>], <span class="comment">// 分号结尾</span></span><br><span class="line">    <span class="attr">semi</span>: [<span class="string">&quot;error&quot;</span>, <span class="string">&quot;always&quot;</span>],</span><br><span class="line">    <span class="string">&quot;no-unused-vars&quot;</span>: [</span><br><span class="line">      <span class="number">2</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 允许声明未使用变量</span></span><br><span class="line">        <span class="attr">vars</span>: <span class="string">&quot;local&quot;</span>, <span class="comment">// 参数不检查</span></span><br><span class="line">        <span class="attr">args</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ], <span class="comment">// 最大空行100</span></span><br><span class="line">    <span class="string">&quot;no-multiple-empty-lines&quot;</span>: [<span class="number">0</span>, &#123; <span class="attr">max</span>: <span class="number">100</span> &#125;],</span><br><span class="line">    <span class="string">&quot;no-mixed-spaces-and-tabs&quot;</span>: [<span class="number">0</span>], <span class="comment">//不能使用console</span></span><br><span class="line">    <span class="string">&quot;no-console&quot;</span>: <span class="string">&quot;off&quot;</span>, <span class="comment">//未定义变量不能使用</span></span><br><span class="line">    <span class="string">&quot;no-undef&quot;</span>: <span class="number">0</span>, <span class="comment">//一行结束后面不要有空格</span></span><br><span class="line">    <span class="string">&quot;no-trailing-spaces&quot;</span>: <span class="number">1</span>, <span class="comment">//强制驼峰法命名</span></span><br><span class="line">    <span class="attr">camelcase</span>: <span class="number">2</span>, <span class="comment">//对象字面量项尾不能有逗号</span></span><br><span class="line">    <span class="string">&quot;comma-dangle&quot;</span>: [<span class="number">2</span>, <span class="string">&quot;never&quot;</span>], <span class="comment">//this别名</span></span><br><span class="line">    <span class="string">&quot;consistent-this&quot;</span>: [<span class="number">2</span>, <span class="string">&quot;that&quot;</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>5、查找 eslint-config-airbnb-base 包 提示如果要支持 es6 以上的语法需要安装 eslint-plugin-import 和 eslint<br>6、安装完成后 配置 package.json 文件 继承 airbnb-base 校验规则<br>7、执行 webpack 检查校验规则是否生效</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">语法检查： eslint-loader  eslint</span><br><span class="line">注意：只检查自己写的源代码，第三方的库是不用检查的</span><br><span class="line">设置检查规则：</span><br><span class="line">package.<span class="property">json</span>中eslintConfig中设置~</span><br><span class="line">  <span class="string">&quot;eslintConfig&quot;</span>: &#123;</span><br><span class="line">     <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;airbnb-base&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">airbnb --&gt; eslint-config-airbnb-base  eslint-plugin-<span class="keyword">import</span> eslint</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="title function_">newESLintPlugin</span>(&#123;</span><br><span class="line">    <span class="attr">fix</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h2 id="搭建本地服务器"><a href="#搭建本地服务器" class="headerlink" title="搭建本地服务器"></a>搭建本地服务器</h2><p>为什么要搭建？</p>
<p>目前我们开发的代码，为了运行需要有两个操作：</p>
<p>操作一：npm run build，编译相关的代码；</p>
<p>操作二：通过 live server 或者直接通过浏览器，打开 index.html 代码，查看效果；</p>
<p>这个过程经常操作会影响我们的开发效率，我们希望可以做到，当文件发生变化时，可以自动的完成 编译 和 展示；</p>
<p>为了完成自动编译，webpack 提供了几种可选的方式：</p>
<p>1、webpack watch mode；<br>2、webpack-dev-server（常用）；<br>3、webpack-dev-middleware；</p>
<h3 id="Webpack-watch"><a href="#Webpack-watch" class="headerlink" title="Webpack watch"></a>Webpack watch</h3><p>webpack 给我们提供了 watch 模式：</p>
<p>在该模式下，webpack 依赖图中的所有文件，只要有一个发生了更新，那么代码将被重新编译；</p>
<p>我们不需要手动去运行 npm run build 指令了；</p>
<p>如何开启 watch 呢？两种方式：</p>
<ul>
<li>方式一：在导出的配置中，添加 watch: true；</li>
<li>方式二：在启动 webpack 的命令中，添加 –watch 的标识；</li>
</ul>
<p>这里我们选择方式二，在 package.json 的 scripts 中添加一个 watch 的脚本：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;npx webpack&quot;</span>,</span><br><span class="line">    <span class="string">&quot;watch&quot;</span>: <span class="string">&quot;webpack --watch&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h2><p>上面的方式可以监听到文件的变化，但是事实上它本身是没有自动刷新浏览器的功能的：</p>
<p>当然，目前我们可以在 VSCode 中使用 live-server 来完成这样的功能；</p>
<p>但是，我们希望在不使用 live-server 的情况下，可以具备 live reloading（实时重新加载）的功能；</p>
<p>安装 webpack-dev-server</p>
<p><strong>npm install webpack-dev-server -D</strong></p>
<p>修改配置文件，告知 dev server，从什么位置查找文件：</p>
<p>contentBase 已经从 webpack5 中移除 使用 static 取代</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="comment">// 主要是指定静态资源的根目录的 下面这种方式已废弃</span></span><br><span class="line">    <span class="comment">// contentBase: &#x27;./public&#x27;,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// webpack5最新的方式</span></span><br><span class="line">    <span class="attr">static</span>: &#123;</span><br><span class="line">       <span class="attr">directory</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>),</span><br><span class="line">     &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>webpack-dev-server 在编译之后不会写入到任何输出文件。而是将 bundle 文件保留在内存中：事实上 webpack-dev-server 使用了一个库叫 memfs（memory-fs webpack 自己写的）</p>
<h2 id="认识模块热替换（HMR）"><a href="#认识模块热替换（HMR）" class="headerlink" title="认识模块热替换（HMR）"></a>认识模块热替换（HMR）</h2><p>什么是 HMR 呢？</p>
<p>HMR 的全称是 Hot Module Replacement，翻译为模块热替换；</p>
<p>模块热替换是指在 应用程序运行过程中，替换、添加、删除模块，而无需重新刷新整个页面；</p>
<p>HMR 通过如下几种方式，来提高开发的速度：</p>
<p>不重新加载整个页面，这样可以保留某些应用程序的状态不丢失；</p>
<p>只更新需要变化的内容，节省开发的时间；</p>
<p>修改了 css、js 源代码，会立即在浏览器更新，相当于直接在浏览器的 devtools 中直接修改样式；</p>
<p>如何使用 HMR 呢？</p>
<p>默认情况下，webpack-dev-server 已经支持 HMR，我们只需要开启即可；</p>
<p>在不开启 HMR 的情况下，当我们修改了源代码之后，整个页面会自动刷新，使用的是 live reloading</p>
<h3 id="开启-HMR"><a href="#开启-HMR" class="headerlink" title="开启 HMR"></a>开启 HMR</h3><p>修改配置文件:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devServer</span>: &#123;</span><br><span class="line"> <span class="attr">static</span>: &#123;</span><br><span class="line">       <span class="attr">directory</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>),</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">hot</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>浏览器控制台查看效果</p>
<p><img src="/img/md/webpack15.png"></p>
<p>但是你会发现，当我们修改了某一个模块的代码时，依然是刷新的整个页面：</p>
<p>这是因为我们需要去指定哪些模块发生更新时，进行 HMR；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;./a.js&quot;</span>;</span><br><span class="line"><span class="comment">// 指定哪些模块发生更新时进行HMR</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">module</span>.<span class="property">hot</span>) &#123;</span><br><span class="line">  <span class="comment">// accept: 认可 同意</span></span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">hot</span>.<span class="title function_">accept</span>(<span class="string">&quot;./a.js&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a.js已经更新啦~~~~~~&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="框架的-HMR"><a href="#框架的-HMR" class="headerlink" title="框架的 HMR"></a>框架的 HMR</h2><p>有一个问题：在开发其他项目时，我们是否需要经常手动去写入 module.hot.accpet 相关的 API 呢？</p>
<p>比如开发 Vue、React 项目，我们修改了组件，希望进行热更新，这个时候应该如何去操作呢？</p>
<p>事实上社区已经针对这些有很成熟的解决方案了：</p>
<p>比如 vue 开发中，我们使用 vue-loader，此 loader 支持 vue 组件的 HMR，提供开箱即用的体验；</p>
<p>比如 react 开发中，有 React Hot Loader，实时调整 react 组件（目前 React 官方已经弃用了，改成使用 react- refresh）；</p>
<h2 id="HRM-原理"><a href="#HRM-原理" class="headerlink" title="HRM 原理"></a>HRM 原理</h2><p>那么 HMR 的原理是什么呢？如何可以做到只更新一个模块中的内容呢？</p>
<p>webpack-dev-server 会创建两个服务：提供静态资源的服务（express）和 Socket 服务（net.Socket）；</p>
<p>express server 负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）；</p>
<p>HMR Socket Server，是一个 socket 的长连接：</p>
<p>长连接有一个最好的好处是建立连接后双方可以通信（服务器可以直接发送文件到客户端）；</p>
<p>当服务器监听到对应的模块发生变化时，会生成两个文件.json（manifest 文件）和.js 文件（update chunk）；</p>
<p>通过长连接，可以直接将这两个文件主动发送给客户端（浏览器）；</p>
<p>浏览器拿到两个新的文件后，通过 HMR runtime 机制，加载这两个文件，并且针对修改的模块进行更新；</p>
<p><img src="/img/md/webpack16.png"></p>
<h2 id="hotOnly、host-配置"><a href="#hotOnly、host-配置" class="headerlink" title="hotOnly、host 配置"></a>hotOnly、host 配置</h2><p>host 设置主机地址：</p>
<p>默认值是 localhost；</p>
<p>如果希望其他地方也可以访问，可以设置为 0.0.0.0；</p>
<p>localhost 和 0.0.0.0 的区别：</p>
<p>localhost：本质上是一个域名，通常情况下会被解析成 127.0.0.1;</p>
<p>127.0.0.1：回环地址(Loop Back Address)，表达的意思其实是我们主机自己发出去的包，直接被自己接收;</p>
<p>正常的数据库包发送过程 应用层 - 传输层 - 网络层 - 数据链路层 - 物理层 ;</p>
<p>而回环地址，是在网络层直接就被获取到了，是不会经常数据链路层和物理层的;</p>
<p>比如我们监听 127.0.0.1 时，在同一个网段下的主机中，通过 ip 地址是不能访问的;</p>
<p>0.0.0.0：监听 IPV4 上所有的地址，再根据端口找到不同的应用程序;</p>
<p>比如我们监听 0.0.0.0 时，在同一个网段下的主机中，通过 ip 地址是可以访问的;</p>
<p><strong>port、open、compress</strong></p>
<p>port 设置监听的端口，默认情况下是 8080</p>
<p>open 是否打开浏览器：</p>
<p>默认值是 false，设置为 true 会打开浏览器；</p>
<p>也可以设置为类似于 Google Chrome 等值；</p>
<p>compress 是否为静态文件开启 gzip compression：</p>
<p>默认值是 false，可以设置为 true；</p>
<p><img src="/img/md/webpack17.png"></p>
<h2 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h2><p>roxy 是我们开发中非常常用的一个配置选项，它的目的设置代理来解决跨域访问的问题：</p>
<p>比如我们的一个 api 请求是 <a target="_blank" rel="noopener" href="http://localhost:8888/">http://localhost:8888</a>， 但是本地启动服务器的域名是 <a target="_blank" rel="noopener" href="http://localhost:8000/">http://localhost:8000</a>， 这个时候发送网络请求就会出现跨域的问题；</p>
<p>那么我们可以将请求先发送到一个代理服务器，代理服务器和 API 服务器没有跨域的问题，就可以解决我们的跨</p>
<p>域问题了；</p>
<p>我们可以进行如下的设置：</p>
<ul>
<li>target：表示的是代理到的目标地址，比如 /api-hy/moment 会被代理到 <a target="_blank" rel="noopener" href="http://localhost:8888/api-hy/moment">http://localhost:8888/api-hy/moment</a>；</li>
<li>pathRewrite：默认情况下，我们的 /api-hy 也会被写入到 URL 中，如果希望删除，可以使用 pathRewrite；</li>
<li>secure：默认情况下不接收转发到 https 的服务器上，如果希望支持，可以设置为 false；</li>
<li>changeOrigin：它表示是否更新代理后请求的 headers 中 host 地址；</li>
</ul>
<h2 id="changeOrigin"><a href="#changeOrigin" class="headerlink" title="changeOrigin"></a>changeOrigin</h2><p>这个 changeOrigin 官方说的非常模糊，通过查看源码我发现其实是要修改代理请求中的 headers 中的 host 属性：</p>
<p>因为我们真实的请求，其实是需要通过 <a target="_blank" rel="noopener" href="http://localhost:8888/">http://localhost:8888</a> 来请求的；</p>
<p>但是因为使用了代码，默认情况下它的值时 <a target="_blank" rel="noopener" href="http://localhost:8000/">http://localhost:8000</a> ；</p>
<p>如果我们需要修改，那么可以将 changeOrigin 设置为 true 即可；</p>
<p><img src="/img/md/webpack18.png"></p>
<h2 id="historyApiFallback"><a href="#historyApiFallback" class="headerlink" title="historyApiFallback"></a>historyApiFallback</h2><p>historyApiFallback 是开发中一个非常常见的属性，它主要的作用是解决 SPA 页面在路由跳转之后，进行页面刷新 时，返回 404 的错误。</p>
<p>boolean 值：默认是 false</p>
<p>如果设置为 true，那么在刷新时，返回 404 错误时，会自动返回 index.html 的内容；</p>
<p>object 类型的值，可以配置 rewrites 属性：</p>
<p>可以配置 from 来匹配路径，决定要跳转到哪一个页面；</p>
<p>事实上 devServer 中实现 historyApiFallback 功能是通过 connect-history-api-fallback 库的：</p>
<p>可以查看 connect-history-api-fallback 文档</p>
<h2 id="resolve-模块解析"><a href="#resolve-模块解析" class="headerlink" title="resolve 模块解析"></a>resolve 模块解析</h2><p>resolve 用于设置模块如何被解析：</p>
<p>在开发中我们会有各种各样的模块依赖，这些模块可能来自于自己编写的代码，也可能来自第三方库；</p>
<p>resolve 可以帮助 webpack 从每个 require/import 语句中，找到需要引入到合适的模块代码；</p>
<p>webpack 使用 enhanced-resolve 来解析文件路径；</p>
<h3 id="webpack-能解析三种文件路径"><a href="#webpack-能解析三种文件路径" class="headerlink" title="webpack 能解析三种文件路径"></a>webpack 能解析三种文件路径</h3><ul>
<li>绝对路径<ul>
<li>由于已经获得文件的绝对路径，因此不需要再做进一步解析。</li>
</ul>
</li>
<li>相对路径<ul>
<li>在这种情况下，使用 import 或 require 的资源文件所处的目录，被认为是上下文目录；</li>
<li>在 import/require 中给定的相对路径，会拼接此上下文路径，来生成模块的绝对路径；</li>
</ul>
</li>
<li>模块路径<ul>
<li>在 resolve.modules 中指定的所有目录检索模块；</li>
<li>默认值是 [‘node_modules’]，所以默认会从 node_modules 中查找文件；</li>
<li>我们可以通过设置别名的方式来替换初识模块路径，具体后面讲解 alias 的配置；</li>
</ul>
</li>
</ul>
<h3 id="确实文件还是文件夹"><a href="#确实文件还是文件夹" class="headerlink" title="确实文件还是文件夹"></a>确实文件还是文件夹</h3><p>如果是一个文件：</p>
<p>如果文件具有扩展名，则直接打包文件；</p>
<p>否则，将使用 resolve.extensions 选项作为文件扩展名解析；</p>
<p>如果是一个文件夹：</p>
<p>会在文件夹中根据 resolve.mainFiles 配置选项中指定的文件顺序查找；</p>
<p>resolve.mainFiles 的默认值是 [‘index’]；</p>
<p>再根据 resolve.extensions 来解析扩展名；</p>
<h2 id="extensions-和-alias-配置"><a href="#extensions-和-alias-配置" class="headerlink" title="extensions 和 alias 配置"></a>extensions 和 alias 配置</h2><p>extensions 是解析到文件时自动添加扩展名：</p>
<p>默认值是 [‘.wasm’, ‘.mjs’, ‘.js’, ‘.json’]；</p>
<p>所以如果我们代码中想要添加加载 .vue 或者 jsx 或者 ts 等文件时，我们必须自己写上扩展名；</p>
<p>另一个非常好用的功能是配置别名 alias：</p>
<p>特别是当我们项目的目录结构比较深的时候，或者一个文件的路径可能需要 …/…/…/这种路径片段；</p>
<p>我们可以给某些常见的路径起一个别名；</p>
<p><img src="/img/md/webpack19.png"></p>
<h1 id="webpack-生产环境配置"><a href="#webpack-生产环境配置" class="headerlink" title="webpack 生产环境配置"></a>webpack 生产环境配置</h1><h2 id="css-提取"><a href="#css-提取" class="headerlink" title="css 提取"></a>css 提取</h2><p>下载插件 <strong>npm install –save-dev mini-css-extract-plugin</strong></p>
<p>修改配置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">MiniCssExtractPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>);</span><br><span class="line"><span class="attr">rules</span>: [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    <span class="attr">use</span>: [</span><br><span class="line">      <span class="comment">//创建 style标签，将样式放入</span></span><br><span class="line">      <span class="comment">// &#x27;style-loader&#x27;,</span></span><br><span class="line">      <span class="comment">//这个 loader取代 style-loader。作用：提取 js中的 css成单独文件</span></span><br><span class="line">      <span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>,</span><br><span class="line">      <span class="comment">//将 css文件整合到 js文件中</span></span><br><span class="line">      <span class="string">&quot;css-loader&quot;</span>,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">    <span class="comment">//对输出的 css文件进行重命名</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;css/built.css&quot;</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h2 id="css-兼容"><a href="#css-兼容" class="headerlink" title="css 兼容"></a>css 兼容</h2><p>往上翻 postcss-preset-env</p>
<h2 id="css-压缩"><a href="#css-压缩" class="headerlink" title="css 压缩"></a>css 压缩</h2><p>下载插件 <strong>npm install –save-dev optimize-css-assets-webpack-plugin</strong></p>
<p>webpack5 改用 <strong>npm i -D css-minimizer-webpack-plugin</strong></p>
<p>修改配置文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;optimize-css-assets-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="attr">plugins</span>: [<span class="keyword">new</span> <span class="title class_">OptimizeCssAssetsWebpackPlugin</span>()];</span><br></pre></td></tr></table></figure>

<h2 id="js-语法检查"><a href="#js-语法检查" class="headerlink" title="js 语法检查"></a>js 语法检查</h2><p>往上翻 eslint</p>
<h2 id="js-兼容处理"><a href="#js-兼容处理" class="headerlink" title="js 兼容处理"></a>js 兼容处理</h2><p>往上翻 babel</p>
<h2 id="js-压缩"><a href="#js-压缩" class="headerlink" title="js 压缩"></a>js 压缩</h2><p>生产环境下会自动压缩 js 代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mode</span>: <span class="string">&#x27;production&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="HTML压缩"><a href="#HTML压缩" class="headerlink" title="HTML压缩"></a>HTML压缩</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">    <span class="attr">template</span>: <span class="string">&#x27;./src/index.html&#x27;</span>,</span><br><span class="line">    <span class="comment">//压缩 html代码</span></span><br><span class="line">    <span class="attr">minify</span>: &#123;</span><br><span class="line">      <span class="comment">//移除空格</span></span><br><span class="line">      <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">//移除注释</span></span><br><span class="line">      <span class="attr">removeComments</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// 移除空元素</span></span><br><span class="line">      <span class="attr">removeEmptyElements</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://Wenzhe6.github.io">李文哲</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wenzhe6.github.io/2020/07/17/WebPack/">https://wenzhe6.github.io/2020/07/17/WebPack/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Wenzhe6.github.io" target="_blank">李文哲的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WebPack/">WebPack</a></div><div class="post_share"><div class="social-share" data-image="/img/webpack.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wx.png" target="_blank"><img class="post-qr-code-img" src="/img/wx.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zfb.png" target="_blank"><img class="post-qr-code-img" src="/img/zfb.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2020/12/17/Vue2/" title="Vue2"><img class="cover" src="/img/v2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Vue2</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1111.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">李文哲</div><div class="author-info__description">初次搭建，请多指教。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Wenzhe6/Wenzhe6.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到李文哲的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#npm-%E7%9B%B8%E5%85%B3"><span class="toc-number">1.</span> <span class="toc-text">npm 相关</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#package-json-%E5%AD%97%E6%AE%B5"><span class="toc-number">1.1.</span> <span class="toc-text">package.json 字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dependencies-VS-devDependencies"><span class="toc-number">1.2.</span> <span class="toc-text">dependencies VS devDependencies</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="toc-number">2.</span> <span class="toc-text">什么是构建工具</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E7%9A%84%E5%8F%91%E5%B1%95"><span class="toc-number">3.</span> <span class="toc-text">构建工具的发展</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.</span> <span class="toc-text">构建工具介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E9%80%82%E5%90%88%E7%9A%84%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7%EF%BC%9F"><span class="toc-number">5.</span> <span class="toc-text">如何选择适合的构建工具？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-webpack"><span class="toc-number">6.</span> <span class="toc-text">什么是 webpack</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%90%86%E8%A7%A3-module%E3%80%81chunk%E3%80%81bundle"><span class="toc-number">7.</span> <span class="toc-text">理解 module、chunk、bundle</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack-%E4%BA%94%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">8.</span> <span class="toc-text">webpack 五个核心概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Entry"><span class="toc-number">8.1.</span> <span class="toc-text">Entry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Output"><span class="toc-number">8.2.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Loader"><span class="toc-number">8.3.</span> <span class="toc-text">Loader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Plugins"><span class="toc-number">8.4.</span> <span class="toc-text">Plugins</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mode"><span class="toc-number">8.5.</span> <span class="toc-text">mode</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack-%E4%BD%BF%E7%94%A8%E5%89%8D%E6%8F%90"><span class="toc-number">9.</span> <span class="toc-text">webpack 使用前提</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack-%E5%AE%89%E8%A3%85"><span class="toc-number">10.</span> <span class="toc-text">webpack 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%82%A3%E4%B9%88%E5%AE%83%E4%BB%AC%E6%98%AF%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB%E5%91%A2%EF%BC%9F"><span class="toc-number">10.1.</span> <span class="toc-text">那么它们是什么关系呢？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack-%E7%9A%84%E9%BB%98%E8%AE%A4%E6%89%93%E5%8C%85"><span class="toc-number">11.</span> <span class="toc-text">webpack 的默认打包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%8C%87%E4%BB%A4"><span class="toc-number">11.1.</span> <span class="toc-text">开发环境指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%8C%87%E4%BB%A4"><span class="toc-number">11.2.</span> <span class="toc-text">生产环境指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-script-%E8%84%9A%E6%9C%AC"><span class="toc-number">11.3.</span> <span class="toc-text">配置 script 脚本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">12.</span> <span class="toc-text">webpack 开发环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">12.1.</span> <span class="toc-text">创建配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E6%A0%B7%E5%BC%8F%E8%B5%84%E6%BA%90"><span class="toc-number">12.2.</span> <span class="toc-text">打包样式资源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%87%86%E5%A4%87-css%E3%80%81less-%E8%B5%84%E6%BA%90"><span class="toc-number">12.2.1.</span> <span class="toc-text">1、准备 css、less 资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85-loader-%E5%8C%85-npm-i-css-loader-D"><span class="toc-number">12.2.2.</span> <span class="toc-text">2、下载安装 loader 包 npm i css-loader -D</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">12.2.3.</span> <span class="toc-text">3、修改配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E8%BF%90%E8%A1%8C%E6%8C%87%E4%BB%A4%EF%BC%9Awebpack-%E6%88%96-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%84%9A%E6%9C%AC-npm-run-build"><span class="toc-number">12.2.4.</span> <span class="toc-text">4、运行指令：webpack 或 自定义脚本 npm run build</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#style-loader"><span class="toc-number">12.3.</span> <span class="toc-text">style-loader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#less-loader"><span class="toc-number">12.4.</span> <span class="toc-text">less-loader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PostCss"><span class="toc-number">12.5.</span> <span class="toc-text">PostCss</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-PostCSS-%E5%91%A2%EF%BC%9F"><span class="toc-number">12.5.1.</span> <span class="toc-text">什么是 PostCSS 呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#autoprefixer"><span class="toc-number">12.5.2.</span> <span class="toc-text">autoprefixer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#postcss-loader"><span class="toc-number">12.5.3.</span> <span class="toc-text">postcss-loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#postcss-preset-env"><span class="toc-number">12.5.4.</span> <span class="toc-text">postcss-preset-env</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%8C%85-HTML-%E8%B5%84%E6%BA%90"><span class="toc-number">12.6.</span> <span class="toc-text">打包 HTML 资源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HtmlWebpackPlugin"><span class="toc-number">12.6.1.</span> <span class="toc-text">HtmlWebpackPlugin</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90"><span class="toc-number">12.7.</span> <span class="toc-text">打包图片资源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#file-loader"><span class="toc-number">12.7.1.</span> <span class="toc-text">file-loader</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90"><span class="toc-number">12.7.1.1.</span> <span class="toc-text">1、创建图片资源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-number">12.7.1.2.</span> <span class="toc-text">文件命名规则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url-loader"><span class="toc-number">12.7.2.</span> <span class="toc-text">url-loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#html-loader"><span class="toc-number">12.7.3.</span> <span class="toc-text">html-loader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E5%85%B6%E5%AE%83%E8%B5%84%E6%BA%90"><span class="toc-number">12.8.</span> <span class="toc-text">打包其它资源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%BC%95%E5%85%A5%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87"><span class="toc-number">12.8.1.</span> <span class="toc-text">1、引入字体图标</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#asset-module-type"><span class="toc-number">13.</span> <span class="toc-text">asset module type</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E5%A6%82%E6%89%93%E5%8C%85%E5%9B%BE%E7%89%87"><span class="toc-number">13.0.1.</span> <span class="toc-text">比如打包图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC-base64"><span class="toc-number">13.0.2.</span> <span class="toc-text">转 base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E5%A6%82%E6%89%93%E5%8C%85%E5%AD%97%E4%BD%93"><span class="toc-number">13.0.3.</span> <span class="toc-text">比如打包字体</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Plugins-1"><span class="toc-number">14.</span> <span class="toc-text">Plugins</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#CleanWebpackPlugin"><span class="toc-number">14.1.</span> <span class="toc-text">CleanWebpackPlugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HtmlWebpackPlugin-1"><span class="toc-number">14.2.</span> <span class="toc-text">HtmlWebpackPlugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DefinePlugin"><span class="toc-number">14.3.</span> <span class="toc-text">DefinePlugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CopyWebpackPlugin"><span class="toc-number">14.4.</span> <span class="toc-text">CopyWebpackPlugin</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Babel-%E7%9B%B8%E5%85%B3"><span class="toc-number">15.</span> <span class="toc-text">Babel 相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Babel-%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">15.0.1.</span> <span class="toc-text">Babel 命令行使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">15.0.2.</span> <span class="toc-text">插件的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Babe-%E7%9A%84%E9%A2%84%E8%AE%BE-preset"><span class="toc-number">15.0.3.</span> <span class="toc-text">Babe 的预设 preset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Babel-%E7%9A%84%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">15.0.4.</span> <span class="toc-text">Babel 的底层原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Babel-%E4%B9%9F%E6%8B%A5%E6%9C%89%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">15.0.5.</span> <span class="toc-text">Babel 也拥有编译器的工作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Babel-%E7%BC%96%E8%AF%91%E5%99%A8%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="toc-number">15.0.6.</span> <span class="toc-text">Babel 编译器执行原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babel-loader"><span class="toc-number">15.0.7.</span> <span class="toc-text">babel-loader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babel-preset-env"><span class="toc-number">15.1.</span> <span class="toc-text">babel&#x2F;preset-env</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babel-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">15.2.</span> <span class="toc-text">babel 配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#corejs"><span class="toc-number">15.3.</span> <span class="toc-text">corejs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eslint"><span class="toc-number">15.4.</span> <span class="toc-text">eslint</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">15.5.</span> <span class="toc-text">搭建本地服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Webpack-watch"><span class="toc-number">15.5.1.</span> <span class="toc-text">Webpack watch</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack-dev-server"><span class="toc-number">15.6.</span> <span class="toc-text">webpack-dev-server</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%BF%E6%8D%A2%EF%BC%88HMR%EF%BC%89"><span class="toc-number">15.7.</span> <span class="toc-text">认识模块热替换（HMR）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%90%AF-HMR"><span class="toc-number">15.7.1.</span> <span class="toc-text">开启 HMR</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%86%E6%9E%B6%E7%9A%84-HMR"><span class="toc-number">15.8.</span> <span class="toc-text">框架的 HMR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HRM-%E5%8E%9F%E7%90%86"><span class="toc-number">15.9.</span> <span class="toc-text">HRM 原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hotOnly%E3%80%81host-%E9%85%8D%E7%BD%AE"><span class="toc-number">15.10.</span> <span class="toc-text">hotOnly、host 配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy"><span class="toc-number">15.11.</span> <span class="toc-text">Proxy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#changeOrigin"><span class="toc-number">15.12.</span> <span class="toc-text">changeOrigin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#historyApiFallback"><span class="toc-number">15.13.</span> <span class="toc-text">historyApiFallback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#resolve-%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90"><span class="toc-number">15.14.</span> <span class="toc-text">resolve 模块解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#webpack-%E8%83%BD%E8%A7%A3%E6%9E%90%E4%B8%89%E7%A7%8D%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="toc-number">15.14.1.</span> <span class="toc-text">webpack 能解析三种文件路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9E%E6%96%87%E4%BB%B6%E8%BF%98%E6%98%AF%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">15.14.2.</span> <span class="toc-text">确实文件还是文件夹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#extensions-%E5%92%8C-alias-%E9%85%8D%E7%BD%AE"><span class="toc-number">15.15.</span> <span class="toc-text">extensions 和 alias 配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack-%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">16.</span> <span class="toc-text">webpack 生产环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#css-%E6%8F%90%E5%8F%96"><span class="toc-number">16.1.</span> <span class="toc-text">css 提取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css-%E5%85%BC%E5%AE%B9"><span class="toc-number">16.2.</span> <span class="toc-text">css 兼容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css-%E5%8E%8B%E7%BC%A9"><span class="toc-number">16.3.</span> <span class="toc-text">css 压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js-%E8%AF%AD%E6%B3%95%E6%A3%80%E6%9F%A5"><span class="toc-number">16.4.</span> <span class="toc-text">js 语法检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js-%E5%85%BC%E5%AE%B9%E5%A4%84%E7%90%86"><span class="toc-number">16.5.</span> <span class="toc-text">js 兼容处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js-%E5%8E%8B%E7%BC%A9"><span class="toc-number">16.6.</span> <span class="toc-text">js 压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML%E5%8E%8B%E7%BC%A9"><span class="toc-number">16.7.</span> <span class="toc-text">HTML压缩</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/21/TypeScript/" title="TypeScript"><img src="/img/TypeScript.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TypeScript"/></a><div class="content"><a class="title" href="/2022/08/21/TypeScript/" title="TypeScript">TypeScript</a><time datetime="2022-08-21T02:38:41.000Z" title="发表于 2022-08-21 10:38:41">2022-08-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/27/NodeJS/" title="Node.JS"><img src="/img/nodejs.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Node.JS"/></a><div class="content"><a class="title" href="/2022/07/27/NodeJS/" title="Node.JS">Node.JS</a><time datetime="2022-07-27T02:38:41.000Z" title="发表于 2022-07-27 10:38:41">2022-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/21/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" title="微信小程序"><img src="/img/wx%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微信小程序"/></a><div class="content"><a class="title" href="/2022/06/21/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" title="微信小程序">微信小程序</a><time datetime="2022-06-21T02:38:41.000Z" title="发表于 2022-06-21 10:38:41">2022-06-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/17/Vue3/" title="Vue3"><img src="/img/v3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vue3"/></a><div class="content"><a class="title" href="/2022/06/17/Vue3/" title="Vue3">Vue3</a><time datetime="2022-06-17T02:00:00.000Z" title="发表于 2022-06-17 10:00:00">2022-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/17/JavaScript/" title="JavaScript"><img src="/img/index.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JavaScript"/></a><div class="content"><a class="title" href="/2020/12/17/JavaScript/" title="JavaScript">JavaScript</a><time datetime="2020-12-17T02:00:00.000Z" title="发表于 2020-12-17 10:00:00">2020-12-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/webpack.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 李文哲</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>